# Ecoregion summary: cost {#sec-ecoSumm-cost}

This section provides a summary of the total cost and cost inclusion probability obtained from the different layers described in @sec-cost-info.
The first figure is the histogram of total cost distribution across the hexagons of an ecoregion.
The second figure illustrates the spatial distribution of cost inclusion probability within the ecoregion.

```{r setup,echo=TRUE,results='hide',warning=FALSE,message=FALSE,echo=FALSE}
library(tidyverse)
library(viridis)
library(sf)

eco_sim = c(
    '7', '28', '30', '31',
    '46', '47', '48', '49',
    '73', '77', '78', '86',
    '72', '74', '75', '76',
    '96', '99', '100', '101',
    '102', '103', '117',
    '216', '217'
)

hexas <- readRDS(file.path('..', 'data', 'hexa_complete.RDS')) |>
  filter(ecoregion %in% eco_sim)
```


```{r printPlotFunc,echo=FALSE,eval=TRUE,fig.width=8,fig.height=6}
ecos <- hexas |>
  pull(ecoregion) |>
  parse_number() |>
  unique()
```


```{r,echo=FALSE,eval=TRUE,fig.width=8,fig.height=6,warning=FALSE,message=FALSE}
for(Eco in ecos)
{
  p1 <- hexas |>
    filter(ecoregion == Eco) |>
    ggplot(aes(costSum)) +
      geom_histogram() +
      theme_minimal() +
      xlab('Hexagon total cost ($)') +
      ylab('') +
      labs(title = paste0('Ecoregion ', Eco))

  p2 <- hexas |>
    filter(ecoregion == Eco) |>
    ggplot() +
      geom_sf(aes(fill = cost_prob), color = 'transparent') +
      coord_sf(crs = 4326) +
      theme_minimal() +
      xlab('') + ylab('') +
      scale_fill_viridis() +
      labs(fill = 'Cost probability')
  
  print(p1)
  print(p2)
}
```

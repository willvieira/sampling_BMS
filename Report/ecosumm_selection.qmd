# Ecoregion summary: selected hexagons {#sec-ecoSumm-selectedhexas}

This section displays the selected PSUs (Primary Sampling Units) for each ecoregion in the 2023 sampling design version.
The GRTS method selects one main hexagon (marked in green) and one over hexagon (blue) for each ecoregion.
As the over hexagon is chosen randomly, we additionally select an extra hexagon (red) next to each main hexagon with the highest inclusion probability among its neighboring hexagons.

```{r setup,echo=TRUE,results='hide',warning=FALSE,message=FALSE,echo=FALSE}
library(tidyverse)
library(viridis)
library(sf)

hexas <- readRDS(file.path('..', 'data', 'hexa_complete.RDS'))
selected_hexas <- readRDS(file.path('data', 'hex_selected.RDS')) |>
  left_join(
    hexas |>
      st_drop_geometry() |>
      select(ET_Index, ecoregion)
  )

```


```{r print,echo=FALSE,message=FALSE,warning=FALSE,eval=TRUE,fig.width=8,fig.height=6}
#| results: asis

ecos <- selected_hexas |>
  pull(ecoregion) |>
  unique()

for(eco in ecos)
{
  cat("## Ecoregion", Eco, "\n\n")

  eco_layer <- hexas |>
    filter(ecoregion == eco & propNA <= 0.8) |>
    st_union()

  p <- eco_layer |>
    ggplot() +
      geom_sf() +
      geom_sf(
        data = selected_hexas |>
          filter(ecoregion == eco),
        aes(
          fill = selection,
          color = selection
        )
      ) +
      coord_sf(crs = 4326) +
      theme_minimal() +
      xlab('') + ylab('') +
      scale_fill_manual(
        values = c('#e41a1c','#4daf4a','#377eb8')
       ) +
      scale_color_manual(
        values = c('#e41a1c','#4daf4a','#377eb8')
      )

  print(p)
}
```

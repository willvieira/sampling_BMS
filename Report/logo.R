# Draw logo on R

library(sf)


#------------------------------------------------------
#------------------------------------------------------

# Create hexagons

#------------------------------------------------------
#------------------------------------------------------

sfc = st_sfc(
    st_polygon(
        list(
            rbind(
                c(0, 0), c(10, 0),
                c(10, 10), c(0, 10), c(0, 0)
            )
        )
    )
)


# Main hexagon
hex <- st_make_grid(sfc, cellsize = 9, square = FALSE)[3]

# inside hexagons
in_hex <- st_intersection(
    st_make_grid(
        hex,
        cellsize = .2,
        square = FALSE        
    ),
    hex
)



#------------------------------------------------------
#------------------------------------------------------

# `BMS` writen in lines

#------------------------------------------------------
#------------------------------------------------------

B <- matrix(
    c(
        1, 1, 2, 2.25, 2.5, 2.5,  2.25, 2, 1, 2, 2.25, 2.5, 2.5, 2.25, 2, 1,
        5.5, 10, 10, 9.88, 9.65, 8.65, 8.42, 8.3, 8.3, 8.3, 8.1, 7.7, 6.1, 5.7, 5.5, 5.5
    ),
    ncol = 2
)

M <- matrix(
    c(
        3.75, 3.75, 4.5, 5.25, 5.25,
        5.5, 10, 8, 10, 5.5
    ),
    ncol = 2    
)


S <- matrix(
    c(
        6.5, 7.5, 7.7, 8.0, 8.0, 7.7, 7.5, 7.0, 6.70, 6.50, 6.50, 06.70, 07.0, 08.0,
        5.5, 5.5, 5.7, 6.1, 7.7, 8.1, 8.3, 8.3, 8.42, 8.65, 9.65, 9.77, 10, 10
    ),
    ncol = 2
)

# B[, 1] <- B[, 1] + .1
# M[, 1] <- M[, 1] + .1
# S[, 1] <- S[, 1] + .1


text = st_multilinestring(list(B, M, S))




#------------------------------------------------------
#------------------------------------------------------

# Intersect letters lines with hexagons

#------------------------------------------------------
#------------------------------------------------------


in_hex_col <- rep(rgb(0, 0, 0, 0), length(in_hex))

png('Report/cover.png', width = 550, height = 550)
par(bg=NA, mar = c(0, 0, 0, 0), oma = c(0, 0, 0, 0))
nGradient = 8
buffSize <- c(0.05, 0.1, 0.15, 0.2, 0.4, 0.5, .55, .6)
colfunc <- colorRampPalette(c("#28f5cc", "#04372f"))

for(i in nGradient:1) {
    in_hex_col[
        st_intersects(
            st_buffer(text, buffSize[i]),
            in_hex
        )[[1]]
    ] <- colfunc(nGradient)[i]
}

plot(hex, col = '#04372f')
plot(in_hex, col = in_hex_col, add = T)

dev.off()
